<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daggerheart Campaign Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/common.css">
    <script defer src="../js/common.js"></script>
</head>
<body class="min-h-screen bg-cover bg-fixed bg-center" id="body-bg">
    <div class="fixed inset-0 bg-slate-950/90 z-[-1]"></div>

    <div id="header-placeholder"></div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    
        <div class="text-center py-16 lg:py-24 relative overflow-hidden rounded-3xl border border-white/10 glass-panel mb-16 shadow-2xl">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-amber-500 via-purple-600 to-amber-500 opacity-75"></div>
            
            <h1 id="campaign-title" class="text-5xl md:text-7xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-200 via-white to-purple-200 mb-6 drop-shadow-lg">Loading...</h1>
            <p id="campaign-desc" class="mt-4 text-xl text-slate-300 max-w-2xl mx-auto font-light"></p>
            
            <div class="mt-10 flex justify-center gap-4">
                <a id="next-session-link" href="sessions.html" class="px-8 py-3 bg-amber-600 hover:bg-amber-500 text-white font-bold rounded-lg shadow-lg shadow-amber-900/50 transition-all flex items-center gap-2">
                    <i data-lucide="calendar"></i> <span id="next-session-btn">Checking Calendar...</span>
                </a>
            </div>
        </div>

        
    </main>

    <footer class="bg-slate-950 border-t border-white/10 py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 mb-2">Campaign Portal</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/data/campaign.yml').then(r => r.text()).then(text => {
                const data = jsyaml.load(text);
                document.getElementById('campaign-title').textContent = data.campaign.title;
                document.getElementById('campaign-desc').textContent = data.campaign.description;
                if(data.campaign.backgroundImage) document.getElementById('body-bg').style.backgroundImage = `url('${data.campaign.backgroundImage}')`;
                fetchNextSession();
            });
            lucide.createIcons();
        });

        function fetchNextSession() {
            fetch('http://localhost:5000/api/next-session')
                .then(res => res.json())
                .then(data => {
                    if (data.date) {
                        const btnText = document.getElementById('next-session-btn');
                        btnText.textContent = `Next Session: ${data.date}`;
                        if (data.link) document.getElementById('next-session-link').href = data.link;
                    } else {
                         document.getElementById('next-session-btn').textContent = "No Upcoming Session";
                    }
                })
                .catch(e => document.getElementById('next-session-btn').textContent = "Next Session: TBD");
        }

        
    </script>
</body>
</html>